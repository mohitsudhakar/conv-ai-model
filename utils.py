from vocab.text import BPEVocab
import torch
import config

config = config.get()
bpe_vocab_path = config['bpe_vocab_path']
bpe_codes_path = config['bpe_codes_path']

def combine_contexts(batch):
    """
    Combine persona with historical contexts
    :param batch:
    :return: context, y
    """
    print(type(batch))
    print(len(batch))
    x, y, p = zip(*batch)

    voc = BPEVocab.from_files(vocab_path=bpe_vocab_path, codes_path=bpe_codes_path)
    print("Persona 1: ",voc.ids2string(p[0]))
    print("Persona 2: ",voc.ids2string(p[1]))
    print("Y 1: ",voc.ids2string(y[0]))
    print("Y 2: ",voc.ids2string(y[1]))

    # Todo: Concat the previous and persona

    return None, None
#
# (
# [5, 3577, 248, 726, 648, 520, 1281, 265, 257, 727, 1389, 1019, 493, 595, 811, 1634, 17025, 7158, 493, 1566, 508, 3860,
#   247, 6, 7, 520, 1267, 588, 971, 1716, 247, 5416, 552, 574, 506, 555, 3906, 31062, 247, 8, 5, 257, 1056, 275, 570, 555,
#   18730, 257, 657, 493, 595, 2282, 834, 530, 811, 692, 22970, 247, 6, 7, 257, 1367, 5379, 4629, 7662, 677, 257, 1056, 603,
#   559, 2885, 5416, 247, 8, 5, 533, 543, 8096, 247, 677, 257, 517, 508, 1591, 1744, 257, 2168, 35724, 508, 11485, 266, 9249,
#   275, 6, 7, 533, 543, 6710, 247, 595, 520, 612, 254, 3906, 7041, 530, 728, 506, 1811, 265, 8, 5, 257, 595, 603, 247, 576,
#   257, 595, 612, 254, 3906, 5097, 1242, 533, 552, 597, 257, 2433, 22434, 247, 6, 7, 607, 552, 712, 3906, 5097, 493, 2433,
#   265, 8, 5, 257, 644, 612, 493, 945, 995, 8519, 13107, 247, 595, 520, 612, 783, 3906, 17802, 265, 6, 7, 257, 657, 5875,
#   530, 32192, 496, 6829, 247, 8, 5, 595, 520, 612, 1041, 3833, 570, 1881, 265, 257, 833, 257, 1056, 805, 493, 595, 811,
#   2282, 834, 247, 6, 7, 257, 1056, 805, 493, 1840, 6218, 247, 607, 648, 520, 2282, 834, 265, 8, 5, 257, 833, 257, 820,
#   767, 811, 12504, 247, 595, 520, 1367, 2208, 38971, 570, 2672, 265, 6],
# [5, 3577, 248, 726, 648, 520, 1281, 1881, 265, 6, 7, 257, 1056, 5670, 728, 564, 555, 290, 5184, 607, 648, 520, 617, 493,
#   8, 5, 4613, 248, 1675, 5184, 247, 676, 1819, 2475, 506, 35015, 247, 6, 7, 533, 552, 254, 878, 1796, 257, 1840, 533, 1008,
#   4169, 8689, 3643, 8, 5, 257, 3806, 247, 607, 595, 520, 595, 570, 254, 1893, 265, 6, 7, 257, 727, 254, 29262, 257, 727,
#   22546, 489, 1626, 533, 36642, 648, 1590, 8, 5, 3674, 247, 257, 727, 254, 12765, 11731, 247, 1694, 897, 3224, 597, 555,
#   728, 512, 489, 3345, 247, 6, 7, 533, 543, 2556, 555, 1639, 1064, 489, 1172, 623, 8, 5, 533, 543, 6710, 247, 257, 612,
#   1128, 566, 254, 1127, 570, 7665, 247, 6]
# )

